<h1><%= @game.name %></h1>

<%# Admin view for game management. %>
<% unless @game.completed? || @game.in_progress %>
	<%= form_tag start_game_path(@game) do %>
		<strong>Team Fee</strong>
		<div class="input-group">
			<span class="input-group-addon">$</span>
			<%= text_field_tag :team_fee, nil, value: number_with_precision(@game.suggested_team_fee, precision: 2), class: "form-control" %>
		</div>
		
		<%= submit_tag "Start", class: "btn btn-success btn-large" %>
	<% end %>
	
	<h2>Teams</h2>
	
	<% if @game.teams.count == 0 %>
		<p>This game does not have any teams yet.</p>
	<% else %>
		<p>
			The following teams are in this game.
			
			<%= link_to "Remove All Teams", remove_all_game_path(@game), method: :post, class: "btn btn-danger" %>
		</p>
		
		<% @game.teams.each_slice(6) do |team_block| %>
			<div class="row">
				<% team_block.each do |team| %>
					<div class="col-md-2">
						<%= image_tag team.logo_url, width: "100%" if team.logo_url %>

						<h4><%= team.name %></h4>

						<%= form_tag remove_game_path(@game) do %>
							<%= hidden_field_tag :name, team.name %>

							<%= submit_tag "Remove", class: "btn btn-danger" %>
						<% end %>
					</div>
				<% end %>
			</div>
		<% end %>
	<% end %>

	<h3>Add Team</h3>

	<% unless Team.not_in_game(@game).empty? %>
		<p>
			The following teams are not currently in this game.

			<%= link_to "Add All Teams", add_all_game_path(@game), method: :post, class: "btn btn-success" %>
		</p>
	<% else %>
		<p>All teams are currently in this game.</p>
	<% end %>

	<%# All of the teams that are not in this game. %>
	<% Team.not_in_game(@game).each_slice(6) do |team_block| %>
		<div class="row">
			<% team_block.each do |team| %>
				<div class="col-md-2">
					<%= image_tag team.logo_url, width: "100%" if team.logo_url %>

					<h4><%= team.name %></h4>
					
					<%= form_tag add_game_path(@game) do %>
						<%= hidden_field_tag :name, team.name %>

						<%= submit_tag "Add", class: "btn btn-success" %>
					<% end %>
				</div>
			<% end %>
		</div>
	<% end %>
<% end %>

<%= link_to "Edit", edit_game_path(@game), class: "btn btn-default" if can?(:update, @game) %>
